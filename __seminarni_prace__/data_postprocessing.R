###############################################################################
###############################################################################
###############################################################################

## merguji vždy dataset "properties_2016" s "train_2016_v2" a dále
## "properties_2017" s "train_2017" -------------------------------------------

for(my_year in c("2016", "2017")){
    
    assign(
        
        paste(
            "merged_data_",
            my_year,
            sep = ""
        ),
        merge(
            x = get(
                paste(
                    "train_",
                    my_year,
                    if(my_year == "2016"){"_v2"},
                    sep = ""
                )
            ),
            y = get(
                paste(
                    "properties_",
                    my_year,
                    sep = ""
                )
            ),
            by = "parcelid",
            all.x = TRUE    # left outer join,
                            # tj. budou zachována všechna "parcelid" z "x",
                            # ale ne nutně všechna "parcelid" z "y"
        )
        
    )
    
    ## logovací hlášky --------------------------------------------------------
    
    flush.console()
    
    print(
        paste(
            "Právě joinovány datasety '",
            paste(
                "train_",
                my_year,
                if(my_year == "2016"){"_v2"},
                sep = ""
            ),
            "' a '",
            paste(
                "properties_",
                my_year,
                sep = ""
            ),
            "'.",
            sep = ""
        )
    )
    
}


## ----------------------------------------------------------------------------

###############################################################################
###############################################################################
###############################################################################





